<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>SizeShiftsImplicationsV2 • SizeShiftsImplicationsV2</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="SizeShiftsImplicationsV2">
<meta name="description" content="Management Strategy Evaluation (MSE) operating model and assessments for salmon body-size shifts, reproducing and extending Ohlberger et al. (2025).
">
<meta property="og:description" content="Management Strategy Evaluation (MSE) operating model and assessments for salmon body-size shifts, reproducing and extending Ohlberger et al. (2025).
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">SizeShiftsImplicationsV2</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/model-walkthrough.html">Model walkthrough (one scenario × one iteration)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gholtgrieve/SizeShiftsImplicationsV2" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="sizeshiftsimplicationsv2">SizeShiftsImplicationsV2<a class="anchor" aria-label="anchor" href="#sizeshiftsimplicationsv2"></a>
</h1></div>
<blockquote>
<p>Fishery management implications of demographic changes in Chinook salmon — packaged for reproducibility, speed, and extensibility.</p>
</blockquote>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><strong>SizeShiftsImplicationsV2</strong> is an R package that implements a management strategy evaluation (MSE) framework for exploring how shifts in age, sex, and length composition propagate through stock–recruit dynamics and harvest control rules originally described in O.lberger et al. (2025). It provides tools to:</p>
<ul>
<li>select scenario grids and run Monte Carlo simulations (optionally in parallel),</li>
<li>save results into a compact, structured <strong><code>ssi_run</code></strong> object,</li>
<li>reproduce publication-quality figures for both the <strong>Ohlberger</strong> study (Figures 2–7) and a new <strong>Kuskokwim River</strong> analysis (Figures A–E).</li>
</ul>
<p>This package accompanies and extends analyses related to Ohlberger et al. (2025) and is designed to make those workflows easier to share, reproduce, and adapt.</p>
</div>
<div class="section level2">
<h2 id="relationship-to-the-original-project">Relationship to the original project<a class="anchor" aria-label="anchor" href="#relationship-to-the-original-project"></a>
</h2>
<p>This package <strong>is based on, builds on, and reuses code from</strong> the original repository by Jan Ohlberger: <strong><code>janohlberger/SizeShiftsImplications</code></strong>.</p>
<div class="section level3">
<h3 id="whats-new-in-v2-differences-in-objective--implementation">What’s new in V2 (differences in objective &amp; implementation)<a class="anchor" aria-label="anchor" href="#whats-new-in-v2-differences-in-objective--implementation"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>R package structure &amp; documentation</strong> – Formalized as an installable package with a consistent API (<code><a href="reference/run_scenarios.html">run_scenarios()</a></code>, <code><a href="reference/make_figures.html">make_figures()</a></code>, etc.), a standard results object (<code>ssi_run</code>), and roxygen2 documentation. This makes the project easier to install, share, test, and cite.</li>
<li>
<strong>Parallel execution</strong> – The simulation runner supports <strong>parallel, scenario‑level execution</strong> (via <code>future</code>/<code>future.apply</code>) with sensible defaults for worker counts and BLAS threading. Large grids complete much faster on multi‑core machines.</li>
<li>
<strong>Kuskokwim River analysis</strong> – Adds a ready‑to‑run parameter profile and figure builders tailored to the Kuskokwim River, producing a parallel set of figures (A–E) for that system.</li>
<li>
<strong>Reproducibility by design</strong> – Seeds and run metadata (e.g., RNG kind, BLAS thread caps, package version, scenario grid hash, timestamps) are recorded inside <code>ssi_run$parameters</code> so runs can be diagnosed and compared later.</li>
<li>
<strong>Unified results object</strong> – All per‑scenario/per‑iteration outputs (e.g., SR parameters, fecundity/egg mass, S_MSY trajectories, observations, implementation errors) are collated into a single <code>ssi_run</code> object and saved to disk alongside a scenario table (Excel). Downstream plotting functions use this object directly.</li>
<li>
<strong>Figure builders</strong> – Programmatic functions to rebuild the Ohlberger (2–7) and Kuskokwim (A–E) figures, writing both <strong>PDF</strong> plots and the underlying <strong>CSV</strong> data used in each figure.</li>
<li>
<strong>Legacy conversion</strong> – A helper to convert legacy outputs into the new <code>ssi_run</code> structure for side‑by‑side comparisons and regression testing.</li>
</ol>
<blockquote>
<p><strong>Attribution</strong>: If you use this package, please also acknowledge the original project and its authors.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Requires <strong>R ≥ 4.1</strong>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Option 1: with pak</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu">pak</span><span class="op">(</span><span class="st">"gholtgrieve/SizeShiftsImplicationsV2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Option 2: with remotes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"gholtgrieve/SizeShiftsImplicationsV2"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>Run a small, parallel test and build a couple of figures.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gholtgrieve.github.io/SizeShiftsImplicationsV2">SizeShiftsImplicationsV2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1) Run a modest grid with reproducible seeds</span></span>
<span><span class="va">run</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_scenarios.html">run_scenarios</a></span><span class="op">(</span></span>
<span>  scenarios  <span class="op">=</span> <span class="st">"all"</span>,        <span class="co"># or a dplyr-style filter string, or c(ID1, ID2, ...)</span></span>
<span>  niter      <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  seed       <span class="op">=</span> <span class="st">"reproducible"</span>,  <span class="co"># or "random"</span></span>
<span>  params     <span class="op">=</span> <span class="st">"Ohlberger"</span>,     <span class="co"># or "Kuskokwim" or a full list of parameters</span></span>
<span>  output_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"outputs"</span><span class="op">)</span>,</span>
<span>  parallel   <span class="op">=</span> <span class="cn">TRUE</span>,             <span class="co"># each worker runs one scenario</span></span>
<span>  workers    <span class="op">=</span> <span class="cn">NULL</span>              <span class="co"># NULL = auto-detect (leaves 1 core free)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2) Recreate publication-style figures (PDF + CSV)</span></span>
<span><span class="fu"><a href="reference/make_figures.html">make_figures</a></span><span class="op">(</span>figures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2"</span>,<span class="st">"3"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">run</span>, figure_dir <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"figures"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="kuskokwim-analysis">Kuskokwim analysis<a class="anchor" aria-label="anchor" href="#kuskokwim-analysis"></a>
</h3>
<p>To run the Kuskokwim River configuration and produce its figures:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run_kusko</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_scenarios.html">run_scenarios</a></span><span class="op">(</span></span>
<span>  scenarios <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  niter     <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  seed      <span class="op">=</span> <span class="st">"reproducible"</span>,</span>
<span>  params    <span class="op">=</span> <span class="st">"Kuskokwim"</span>,</span>
<span>  parallel  <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/make_figures.html">make_figures</a></span><span class="op">(</span><span class="st">"Kuskokwim"</span>, data <span class="op">=</span> <span class="va">run_kusko</span>, figure_dir <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"figures"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-ssi_run-object">The <code>ssi_run</code> object<a class="anchor" aria-label="anchor" href="#the-ssi_run-object"></a>
</h2>
<p>A run returns (and saves) a <strong>single artifact</strong>:</p>
<ul>
<li>
<code>meta</code>: timestamp, number of scenarios/iterations, seed mode/list, profile, output_dir.</li>
<li>
<code>scenarios</code>: the exact scenario table that was executed.</li>
<li>
<code>results</code>: per‑scenario/per‑iteration lists including: <code>para</code>, <code>sr_sim</code>, <code>fec</code>, <code>egg</code>, <code>S_msy</code>, <code>data</code>, <code>obs</code>, <code>ret_by_age</code>, <code>meanSaA</code>, <code>propfemale</code>, <code>selectivity</code>, <code>MSY_Goals</code>, <code>impl_errors</code>.</li>
</ul>
<p>A serialized copy is written to <code>outputs/run_&lt;timestamp&gt;.rds</code>, and the scenario table is also exported to <code>run_&lt;timestamp&gt;_scen.xlsx</code> for quick inspection. Figure builders write <code>FigureX.pdf</code> + matching <code>FigureX.csv</code> under <code>figures/</code>.</p>
</div>
<div class="section level2">
<h2 id="parallel-performance--reproducibility-tips">Parallel performance &amp; reproducibility tips<a class="anchor" aria-label="anchor" href="#parallel-performance--reproducibility-tips"></a>
</h2>
<ul>
<li><p><strong>Seeds</strong>: <code>seed = "reproducible"</code> uses common random numbers (CRN) across scenarios so iteration <em>k</em> is seeded identically across the grid. <code>seed = "random"</code> samples seeds for each iteration.</p></li>
<li><p><strong>Workers</strong>: If <code>workers = NULL</code>, the package auto‑detects cores, caps workers at the number of scenarios, and <strong>leaves one core free</strong> for the OS.</p></li>
<li>
<p><strong>BLAS threads</strong>: To avoid oversubscription in parallel runs, limit BLAS threads before running:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>OMP_NUM_THREADS <span class="op">=</span> <span class="st">"1"</span>, MKL_NUM_THREADS <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"RhpcBLASctl"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu">RhpcBLASctl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RhpcBLASctl/man/RhpcBLASctl-package.html" class="external-link">blas_set_num_threads</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="figures">Figures<a class="anchor" aria-label="anchor" href="#figures"></a>
</h2>
<ul>
<li>
<strong>Ohlberger</strong>: 2–7 (e.g., S_MSY distributions with 50%/80% bands; harvest/return comparisons; YPR/DLM percentage differences relative to TRM; etc.).</li>
<li>
<strong>Kuskokwim</strong>: A–E (system‑specific metrics; probability of zero harvest versus harvest; etc.).</li>
</ul>
<p>Each builder also saves the tidy <strong>CSV</strong> used to draw the figure to make manuscript tables/QA straightforward.</p>
</div>
<div class="section level2">
<h2 id="migrating-legacy-outputs">Migrating legacy outputs<a class="anchor" aria-label="anchor" href="#migrating-legacy-outputs"></a>
</h2>
<p>Use the included converter to produce a faithful <code>ssi_run</code> for from legacy output derived from the <strong><code>janohlberger/SizeShiftsImplications</code></strong> version of the model.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssi</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/convert_legacy_to_ssi.html">convert_legacy_to_ssi</a></span><span class="op">(</span><span class="va">path_to_Rdata_or_env</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>Best efforts to address issues will be made as they arise but recognize this package is made available for reproducability purposes, not as maintained software.</p>
</div>
<div class="section level2">
<h2 id="citing">Citing<a class="anchor" aria-label="anchor" href="#citing"></a>
</h2>
<p>If this package or its figures contributed to your work, please cite:</p>
<blockquote>
<p>Ohlberger, J., Schindler, D. E., &amp; Staton, B. A. (2025). Accounting for salmon body size declines in fishery management can reduce conservation risks. <em>Fish and Fisheries</em>, 26, 113–130.<a href="https://doi.org/10.1111/faf.12869" class="external-link"></a><a href="https://doi.org/10.1111/faf.12869" class="external-link">https://doi.org/10.1111/faf.12869</a></p>
</blockquote>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>GPL-3.0 (same as this package). See <code>LICENSE</code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/gholtgrieve/SizeShiftsImplicationsV2/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/gholtgrieve/SizeShiftsImplicationsV2/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing SizeShiftsImplicationsV2</a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gholtgrieve" class="external-link">Gordon Holtgrieve</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
